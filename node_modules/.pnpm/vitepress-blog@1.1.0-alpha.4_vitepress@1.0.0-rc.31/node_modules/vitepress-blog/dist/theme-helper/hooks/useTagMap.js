/*! 
 * vitepress-blog v1.1.0-alpha.3
 * (c) yue1123
 * Homepage: https://github.com/yue1123/vitepress-blog
 * Released under the MIT License.
 */
import { usePostListWithPagination } from './usePostListWithPagination.js';
import { shallowReactive, shallowReadonly } from 'vue';

function useTagMap() {
  const { allPostList } = usePostListWithPagination();
  const tagMap = shallowReactive(/* @__PURE__ */ Object.create(null));
  for (const post of allPostList.value) {
    if (post.tags) {
      for (const tag of post.tags) {
        if (!tagMap[tag]) {
          tagMap[tag] = {
            title: tag,
            count: 0,
            posts: []
          };
        }
        const cacheObj = tagMap[tag];
        cacheObj.count += 1;
        cacheObj.posts.push(post);
      }
    }
  }
  return shallowReadonly(tagMap);
}

export { useTagMap };
